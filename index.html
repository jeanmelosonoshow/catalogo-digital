<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Cat치logo Profissional Estofados</title>
    
    <script src="https://unpkg.com/page-flip/dist/js/page-flip.browser.js"></script>

    <style>
        :root { --bg-color: #121212; }
        body {
            margin: 0; padding: 0; background: var(--bg-color);
            font-family: sans-serif; overflow: hidden;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            min-height: 100vh;
        }

        #book-container {
            position: relative; width: 100vw; height: 75vh;
            display: flex; justify-content: center; align-items: center;
        }

        .page { background-color: var(--bg-color); width: 100%; height: 100%; }
        .page img { width: 100%; height: 100%; object-fit: contain; pointer-events: none; }

        /* Bot칚o Lupa */
        #zoom-trigger {
            position: fixed; bottom: 80px; right: 20px;
            width: 55px; height: 55px; background: #fff;
            border-radius: 50%; display: flex; justify-content: center;
            align-items: center; cursor: pointer; z-index: 100;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4); font-size: 24px;
        }

        /* Modal de Zoom */
        #zoom-modal {
            display: none; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; background: rgba(0,0,0,0.98);
            z-index: 2000; justify-content: center; align-items: center;
        }

        #zoom-modal img { max-width: 95%; max-height: 85%; object-fit: contain; }

        .zoom-nav {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.2); color: white; border: none;
            padding: 20px; cursor: pointer; font-size: 24px; border-radius: 5px;
        }
        #zoom-prev { left: 10px; }
        #zoom-next { right: 10px; }

        #close-zoom {
            position: absolute; top: 20px; right: 20px;
            width: 45px; height: 45px; background: #fff; color: #000;
            border-radius: 50%; display: flex; justify-content: center;
            align-items: center; font-size: 24px; cursor: pointer; font-weight: bold;
        }

        #controls {
            margin-top: 15px; color: white;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 25px; border-radius: 30px; font-size: 14px;
        }
    </style>
</head>
<body>

<div id="book-container">
    <div id="book"></div>
</div>

<div id="zoom-trigger" onclick="openZoom()">游댌</div>

<div id="controls">
    P치gina: <span id="current-page">1</span> / 6
</div>

<div id="zoom-modal">
    <div id="close-zoom" onclick="closeZoom()">칑</div>
    <button id="zoom-prev" class="zoom-nav" onclick="changeZoomPage(-1)">&#10094;</button>
    <img id="zoom-img" src="">
    <button id="zoom-next" class="zoom-nav" onclick="changeZoomPage(1)">&#10095;</button>
</div>

<script>
    let pageFlip;
    let zoomIdx = 0;
    const isMobile = window.innerWidth <= 768;
    const totalPages = 6;
    const folder = isMobile ? 'pages/mobile/' : 'pages/';

    // 1. Criar P치ginas
    const bookElement = document.getElementById('book');
    for (let i = 1; i <= totalPages; i++) {
        const pageDiv = document.createElement('div');
        pageDiv.className = 'page';
        pageDiv.innerHTML = `<img src="${folder}page_${i}.jpg">`;
        bookElement.appendChild(pageDiv);
    }

    window.onload = () => {
        // CORRE칂츾O MOBILE: Usar a largura real do dispositivo para evitar o modo "duo"
        const bookWidth = isMobile ? window.innerWidth : 550;
        const bookHeight = isMobile ? window.innerHeight * 0.7 : 750;

        pageFlip = new St.PageFlip(bookElement, {
            width: bookWidth,
            height: bookHeight,
            size: "stretch",
            minWidth: 300,
            maxWidth: 1000,
            minHeight: 400,
            maxHeight: 1500,
            showCover: false,
            usePortrait: true, // For칞a modo retrato (uma p치gina)
            drawShadow: true,
            mobileScrollSupport: true,
            clickEventForward: false
        });

        pageFlip.loadFromHTML(document.querySelectorAll(".page"));

        pageFlip.on('flip', (e) => {
            document.getElementById('current-page').innerText = e.data + 1;
        });
    };

    // 2. L칩gica do Zoom Inteligente
    function openZoom() {
        // Pega a p치gina exata em que o livro est치 no momento do clique
        zoomIdx = pageFlip.getCurrentPageIndex() + 1;
        updateZoomImage();
        document.getElementById('zoom-modal').style.display = 'flex';
    }

    function changeZoomPage(step) {
        zoomIdx += step;
        if (zoomIdx < 1) zoomIdx = totalPages;
        if (zoomIdx > totalPages) zoomIdx = 1;
        updateZoomImage();
    }

    function updateZoomImage() {
        document.getElementById('zoom-img').src = `${folder}page_${zoomIdx}.jpg`;
    }

    function closeZoom() {
        document.getElementById('zoom-modal').style.display = 'none';
        // Sincroniza o livro com a p치gina que o utilizador parou no zoom
        pageFlip.flip(zoomIdx - 1);
    }

    window.addEventListener('resize', () => {
        if ((window.innerWidth <= 768) !== isMobile) location.reload();
    });
</script>

</body>
</html>
